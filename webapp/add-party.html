<!doctype html>
<head>
<title>Dedguenodgo add party</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="favicon.ico" rel="icon" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="css/lib/bootstrap.min.css" />
<link rel="stylesheet" type="text/css"
	href="css/lib/bootstrap-theme.min.css" />
</head>
<body>
	<form action="/REST/party" method="POST" class="form">
package nonoel

import (
	"appengine"
	"appengine/datastore"
	"golang.org/x/crypto/bcrypt"
)

var ErrInvalidPassword = bcrypt.ErrMismatchedHashAndPassword

type adminPassword struct {
	Password []byte
}

func CheckOrSetAdminPassword(c appengine.Context, password string) error {
	key := datastore.NewKey(c, "adminPassword", "singleton", 0, nil)
	current := new(adminPassword)
	var err = datastore.Get(c, key, current)
	switch err {
	case nil:
		// check password
		return bcrypt.CompareHashAndPassword(current.Password, []byte(password))
	case datastore.ErrNoSuchEntity:
		// no current password
		// store new password and exit
		hashed, err := bcrypt.GenerateFromPassword([]byte(password), bcrypt.DefaultCost)
		if err != nil {
			return err
		}
		var toStore = &adminPassword{hashed}
		_, err = datastore.Put(c, key, toStore)
		return err
	default:
		return err
	}
}
		<div class="form-group">
			<label for="admin-password">Admin password</label>
			<input class="form-control" type="password" id="admin-password" name="adminPassword" />
		</div>
		<div class="form-group">
			<label for="party-name">Party name</label>
			<input class="form-control" type="text" id="party-name" name="partyName" />
		</div>
		<div class="form-group">
			<label for="party-password">Party password</label>
			<input class="form-control" type="password" id="party-password" name="partyPassword" />
		</div>
		<button type="submit">Create</button>
	</form>
</body>

<!doctype html>
<head>
	<title>Dedguenodgo - login</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link href="favicon.ico" rel="icon" type="image/x-icon" />
	<link rel="stylesheet" type="text/css" href="css/lib/bootstrap.min.css" />
	<link rel="stylesheet" type="text/css" href="css/lib/bootstrap-theme.min.css" />
	<link rel="stylesheet" type="text/css" href="css/style.css" />
</head>
<body>
	<h1>Dedguenodgo - Connexion</h1>
	<div class="container">
		<form class="form" data-bind="submit: function() {$root.submitParty();}">
			<div class="form-group">
				<label>Nom de l'évènement</label>
				<input class="form-control" type="text" data-bind="value:partyId"/>
			</div>
			<div class="form-group">
				<label>Mot de passe de l'évènement</label>
				<input class="form-control" type="password" data-bind="value:partyPassword"/>
			</div>
			<div class="form-group">
				<button class="btn btn-primary" type="submit">Connexion</button>
			</div>
		</form>
		<div class="alert alert-info" data-bind="visible: loadingParty">Vérification de l'événement...</div>
		<div class="alert alert-success" data-bind="visible: partyOk">Evénement vérifié !</div>
		<form class="form" data-bind="visible: partyOk, submit: function() {$root.submitUser();}">
			<div class="form-group">
				<label>Utilisateur</label>
				<select class="form-control" data-bind="visible: users(), options: users, value: userId, optionsText:'name', optionsCaption: 'choisir...'"></select> 
			</div>
			<div class="form-group">
				<button data-bind="enable: userId" class="btn btn-primary" type="submit">Connexion</button>
				<span> --- </span>
				<button class="btn btn-xs btn-primary" data-bind="click:function() {$root.addUser();}">Ajouter un utilisateur</button>
				<button class="btn btn-xs btn-danger" data-bind="visible: userId, click:function() {$root.deleteUser());}">Supprimer cet utilisateur</button>
			</div>
		</form>
		<div class="alert alert-info" data-bind="visible: loadingUser">Appel du serveur...</div>
		<div class="alert alert-success" data-bind="visible: userOk">OK !</div>
	</div>
	<script src="js/lib/jquery.min.js"></script>
	<script src="js/lib/knockout-3.0.0.debug.js"></script>
	<script src="js/login.js"></script>
	<script>
		$(document).ready(function() {
			var mockModelLoaded = !/demo/.test(location.search) ? $.when() : $.getScript('js/localstorage-model.js');
			$.when(mockModelLoaded).pipe(function() {
				return window.createViewModel();
			})
			.always(function() {
				$("body").removeClass('loading');
				}).fail(function(viewModel) {
				$("body").addClass('error');
				}).done(function(viewModel) {
				window.viewModel = viewModel;
				ko.applyBindings(window.viewModel);
			});
		});
	</script>

</body>
